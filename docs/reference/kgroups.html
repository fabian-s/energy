<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>K-Groups Clustering — kgroups • energy</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="K-Groups Clustering — kgroups"><meta property="og:description" content="Perform k-groups clustering by energy distance."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">energy</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.7-11</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/mariarizzo/energy/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>K-Groups Clustering</h1>
    
    <div class="hidden name"><code>kgroups.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Perform k-groups clustering by energy distance.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">kgroups</span><span class="op">(</span><span class="va">x</span>, <span class="va">k</span>, iter.max <span class="op">=</span> <span class="fl">10</span>, nstart <span class="op">=</span> <span class="fl">1</span>, cluster <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>Data frame or data matrix or distance object</p></dd>

  <dt>k</dt>
<dd><p>number of clusters</p></dd>

  <dt>iter.max</dt>
<dd><p>maximum number of iterations</p></dd>

  <dt>nstart</dt>
<dd><p>number of restarts</p></dd>

  <dt>cluster</dt>
<dd><p>initial clustering vector</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>K-groups is based on the multisample energy distance for comparing distributions.
Based on the disco decomposition of total dispersion (a Gini type mean distance) the objective function should either maximize the total between cluster energy distance, or equivalently, minimize the total within cluster energy distance. It is more computationally efficient to minimize within distances, and that makes it possible to use a modified version of the Hartigan-Wong algorithm (1979) to implement K-groups clustering.</p>
<p>The within cluster Gini mean distance is
$$G(C_j) = \frac{1}{n_j^2} \sum_{i,m=1}^{n_j} |x_{i,j} - x_{m,j}|$$
and the K-groups within cluster distance is
$$W_j = \frac{n_j}{2}G(C_j) = \frac{1}{2 n_j} \sum_{i,m=1}^{n_j} |x_{i,j} - x_{m,j}.$$
If z is the data matrix for cluster \(C_j\), then \(W_j\) could be computed as
<code>sum(dist(z)) / nrow(z)</code>.</p>
<p>If cluster is not NULL, the clusters are initialized by this vector (can be a factor or integer vector). Otherwise clusters are initialized with random labels in k approximately equal size clusters.</p>
<p>If <code>x</code> is not a distance object (class(x) == "dist") then <code>x</code> is converted to a data matrix for analysis.</p>
<p>Run up to <code>iter.max</code> complete passes through the data set until a local min is reached. If <code>nstart &gt; 1</code>, on second and later starts, clusters are initialized at random, and the best result is returned.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    

<p>An object of class <code>kgroups</code> containing the components</p>
<dl><dt>call</dt>
<dd><p>the function call</p></dd>

<dt>cluster</dt>
<dd><p>vector of cluster indices</p></dd>

<dt>sizes</dt>
<dd><p>cluster sizes</p></dd>

<dt>within</dt>
<dd><p>vector of Gini within cluster distances</p></dd>

<dt>W</dt>
<dd><p>sum of within cluster distances</p></dd>

<dt>count</dt>
<dd><p>number of moves</p></dd>

<dt>iterations</dt>
<dd><p>number of iterations</p></dd>

<dt>k</dt>
<dd><p>number of clusters</p></dd>


</dl><p><code>cluster</code> is a vector containing the group labels, 1 to k. <code>print.kgroups</code></p>


<p>prints some of the components of the kgroups object.</p>


<p>Expect that count is 0 if the algorithm converged to a local min (that is, 0 moves happened on the last iteration). If iterations equals iter.max and count is positive, then the algorithm did not converge to a local min.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Maria Rizzo and Songzi Li</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Li, Songzi (2015).
"K-groups: A Generalization of K-means by Energy Distance."
Ph.D. thesis, Bowling Green State University.</p>
<p>Li, S. and Rizzo, M. L. (2017).
"K-groups: A Generalization of K-means Clustering".
ArXiv e-print 1711.04359. https://arxiv.org/abs/1711.04359</p>
<p>Szekely, G. J., and M. L. Rizzo. "Testing for equal distributions in high dimension." InterStat 5, no. 16.10 (2004).</p>
<p>Rizzo, M. L., and G. J. Szekely. "Disco analysis: A nonparametric extension of analysis of variance." The Annals of Applied Statistics (2010): 1034-1055.</p>
<p>Hartigan, J. A. and Wong, M. A. (1979). "Algorithm AS 136: A K-means clustering algorithm." Applied Statistics, 28, 100-108. doi: 10.2307/2346830.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span> ,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">kg</span> <span class="op">&lt;-</span> <span class="fu">kgroups</span><span class="op">(</span><span class="va">x</span>, k <span class="op">=</span> <span class="fl">3</span>, iter.max <span class="op">=</span> <span class="fl">5</span>, nstart <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">kg</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> kgroups(x = x, k = 3, iter.max = 5, nstart = 2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> K-groups cluster analysis</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  groups of size  50 38 62 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Within cluster distances:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  17.07201 18.92376 31.53301</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iterations:  3   Count:  0 </span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">kg</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 3 3 2 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [75] 3 3 3 2 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 2 3 2 2 2 2 3 2 2 2 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [112] 2 2 3 3 2 2 2 2 3 2 3 2 3 2 2 3 3 2 2 2 2 2 3 2 2 2 2 3 2 2 2 3 2 2 2 3 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [149] 2 3</span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># \donttest{</span></span></span>
<span class="r-in"><span>    <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">kg</span> <span class="op">&lt;-</span> <span class="fu">kgroups</span><span class="op">(</span><span class="va">d</span>, k <span class="op">=</span> <span class="fl">3</span>, iter.max <span class="op">=</span> <span class="fl">5</span>, nstart <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">kg</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> kgroups(x = d, k = 3, iter.max = 5, nstart = 2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> K-groups cluster analysis</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  groups of size  50 38 62 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Within cluster distances:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  17.07201 18.92376 31.53301</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iterations:  3   Count:  0 </span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="va">kg</span><span class="op">$</span><span class="va">cluster</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 3 3 2 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [75] 3 3 3 2 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 2 3 2 2 2 2 3 2 2 2 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [112] 2 2 3 3 2 2 2 2 3 2 3 2 3 2 2 3 3 2 2 2 2 2 3 2 2 2 2 3 2 2 2 3 2 2 2 3 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [149] 2 3</span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">kg</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 3 3 2 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [75] 3 3 3 2 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 2 3 2 2 2 2 3 2 2 2 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [112] 2 2 3 3 2 2 2 2 3 2 3 2 3 2 2 3 3 2 2 2 2 2 3 2 2 2 2 3 2 2 2 3 2 2 2 3 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [149] 2 3</span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">kg</span>, method <span class="op">=</span> <span class="st">"groups"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26] 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  53  78 101 103 104 105 106 108 109 110 111 112 113 116 117 118 119 121 123</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20] 125 126 129 130 131 132 133 135 136 137 138 140 141 142 144 145 146 148 149</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  51  52  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20]  71  72  73  74  75  76  77  79  80  81  82  83  84  85  86  87  88  89  90</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [39]  91  92  93  94  95  96  97  98  99 100 102 107 114 115 120 122 124 127 128</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [58] 134 139 143 147 150</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span>    <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Maria Rizzo, Gabor Szekely.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

